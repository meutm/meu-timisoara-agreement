<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MEU Timisoara 2026 — Acord de Participare</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant:ital,wght@0,300;0,400;1,300;1,400&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Jost:wght@300;400;500;600&display=swap" rel="stylesheet"/>
  <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
  <style>
    :root{--ink:#0b1626;--ink2:#1c2e4a;--ink3:#2e4a6e;--gold:#b8902a;--pale:#e8d49a;--rule:#d6dce8;--rdark:rgba(255,255,255,.09);--paper:#f7f6f2;--white:#fff;--muted:#8a96aa;--sig-blue:#1a4fa3;}
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
    html{height:100%;scroll-behavior:smooth;}
    body{font-family:'Jost',sans-serif;background:var(--paper);color:var(--ink);min-height:100vh;display:grid;grid-template-columns:360px 1fr;}
    .pl{background:var(--ink);position:sticky;top:0;height:100vh;display:flex;flex-direction:column;padding:48px 40px;overflow:hidden;}
    .pl::before{content:'';position:absolute;inset:0;background-image:linear-gradient(rgba(255,255,255,.022) 1px,transparent 1px),linear-gradient(90deg,rgba(255,255,255,.022) 1px,transparent 1px);background-size:36px 36px;pointer-events:none;}
    .pl::after{content:'';position:absolute;bottom:-100px;right:-100px;width:360px;height:360px;border:1px solid rgba(184,144,42,.12);border-radius:50%;pointer-events:none;}
    .li{position:relative;z-index:1;flex:1;display:flex;flex-direction:column;}
    .lt{display:inline-flex;align-items:center;align-self:flex-start;margin-bottom:44px;border:1px solid var(--rdark);border-radius:3px;overflow:hidden;}
    .lb{padding:5px 13px;font-family:'Jost',sans-serif;font-size:.65rem;font-weight:600;letter-spacing:1.8px;text-transform:uppercase;color:rgba(255,255,255,.32);background:transparent;border:none;cursor:pointer;transition:all .18s;}
    .lb.on{background:var(--gold);color:#fff;}
    .lsep{width:1px;height:26px;background:var(--rdark);}
    .ring{width:52px;height:52px;margin-bottom:28px;}
    .ring svg{animation:spin 40s linear infinite;}
    @keyframes spin{to{transform:rotate(360deg);}}
    .lh{font-family:'Cormorant',serif;font-size:2.3rem;font-weight:300;line-height:1.18;color:#fff;margin-bottom:7px;}
    .lh em{font-style:italic;color:var(--pale);}
    .ls2{font-size:.78rem;font-weight:300;color:rgba(255,255,255,.36);letter-spacing:.4px;margin-bottom:36px;line-height:1.5;}
    .ml{list-style:none;border-top:1px solid var(--rdark);}
    .mi{display:flex;align-items:flex-start;gap:11px;padding:13px 0;border-bottom:1px solid var(--rdark);}
    .mic{flex-shrink:0;margin-top:1px;opacity:.42;}
    .mil{display:block;font-size:.6rem;font-weight:600;letter-spacing:1.8px;text-transform:uppercase;color:var(--gold);margin-bottom:2px;}
    .miv{font-size:.78rem;font-weight:300;color:rgba(255,255,255,.62);}
    .snav{margin-top:auto;padding-top:20px;border-top:1px solid var(--rdark);}
    .snav-label{font-size:.6rem;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.2);margin-bottom:12px;}
    .step-item{display:flex;align-items:center;gap:10px;padding:7px 0;cursor:pointer;}
    .step-num{width:20px;height:20px;border-radius:50%;border:1px solid rgba(255,255,255,.18);display:flex;align-items:center;justify-content:center;font-size:.6rem;font-weight:600;color:rgba(255,255,255,.3);flex-shrink:0;transition:all .2s;}
    .step-item.active .step-num{background:var(--gold);border-color:var(--gold);color:#fff;}
    .step-item.done .step-num{background:rgba(34,197,94,.18);border-color:rgba(34,197,94,.4);color:rgba(34,197,94,.8);}
    .step-text{font-size:.7rem;font-weight:300;color:rgba(255,255,255,.28);transition:color .2s;}
    .step-item.active .step-text{color:rgba(255,255,255,.72);}
    .step-item.done .step-text{color:rgba(255,255,255,.4);}
    .pr{display:flex;flex-direction:column;min-height:100vh;}
    .tb{height:50px;border-bottom:1px solid var(--rule);display:flex;align-items:center;justify-content:space-between;padding:0 52px;flex-shrink:0;position:sticky;top:0;background:var(--paper);z-index:10;}
    .tbl{font-size:.66rem;font-weight:500;letter-spacing:1.8px;text-transform:uppercase;color:var(--muted);}
    .sp{display:flex;align-items:center;gap:6px;}
    .sd{width:6px;height:6px;border-radius:50%;background:#22c55e;animation:blink 2.5s ease-in-out infinite;}
    @keyframes blink{0%,100%{opacity:1}50%{opacity:.35}}
    .st{font-size:.65rem;font-weight:500;letter-spacing:1.2px;text-transform:uppercase;color:var(--muted);}
    .rm{flex:1;padding:40px 52px;max-width:660px;}
    .section-block{margin-bottom:44px;}
    .fe{display:flex;align-items:center;gap:11px;margin-bottom:13px;}
    .fel{width:26px;height:1px;background:var(--gold);}
    .fet{font-size:.63rem;font-weight:600;letter-spacing:2.5px;text-transform:uppercase;color:var(--gold);}
    .ft{font-family:'Cormorant Garamond',serif;font-size:2.1rem;font-weight:600;color:var(--ink);line-height:1.15;letter-spacing:-.3px;margin-bottom:8px;}
    .fd{font-size:.83rem;font-weight:300;color:var(--muted);line-height:1.65;margin-bottom:32px;}
    .sdiv{display:flex;align-items:center;gap:14px;margin-bottom:22px;margin-top:8px;}
    .sdiv-line{flex:1;height:1px;background:var(--rule);}
    .sdiv-label{font-size:.6rem;font-weight:600;letter-spacing:2.2px;text-transform:uppercase;color:var(--muted);}
    .fi{margin-bottom:20px;}
    .fll{display:flex;align-items:center;gap:7px;margin-bottom:8px;}
    .fll svg{color:var(--muted);flex-shrink:0;}
    .flt{font-size:.66rem;font-weight:600;letter-spacing:1.8px;text-transform:uppercase;color:var(--ink2);}
    .freq{color:var(--gold);font-size:.85rem;line-height:1;}
    input[type="text"],input[type="email"],input[type="tel"]{width:100%;padding:13px 14px;border:1px solid var(--rule);border-radius:0;font-family:'Jost',sans-serif;font-size:.88rem;color:var(--ink);background:#fff;outline:none;transition:border-color .18s,box-shadow .18s;}
    input:focus{border-color:var(--ink3);box-shadow:0 0 0 2px rgba(46,74,110,.07);}
    input.err{border-color:#c0392b;}
    .agree-box{border:1px solid var(--rule);background:#fff;height:340px;overflow-y:auto;padding:24px 26px;font-size:.79rem;font-weight:300;line-height:1.8;color:var(--ink2);margin-bottom:18px;position:relative;}
    .agree-box::-webkit-scrollbar{width:4px;}
    .agree-box::-webkit-scrollbar-thumb{background:var(--ink3);border-radius:2px;}
    .agree-title{font-family:'Cormorant Garamond',serif;font-size:1.05rem;font-weight:600;color:var(--ink);margin-bottom:4px;line-height:1.3;}
    .agree-subtitle{font-size:.72rem;font-weight:300;color:var(--muted);margin-bottom:18px;line-height:1.5;}
    .agree-section{margin-top:16px;}
    .agree-section-title{font-size:.72rem;font-weight:600;letter-spacing:1.2px;text-transform:uppercase;color:var(--ink);margin-bottom:7px;}
    .agree-para{margin-bottom:8px;font-size:.79rem;line-height:1.78;}
    .agree-scroll-fade{position:sticky;bottom:0;left:0;right:0;height:40px;background:linear-gradient(to top,rgba(255,255,255,.95),transparent);pointer-events:none;}
    .check-row{display:flex;align-items:flex-start;gap:12px;padding:16px;border:1px solid var(--rule);background:#fff;margin-bottom:24px;transition:border-color .2s;cursor:pointer;}
    .check-row.checked{border-color:rgba(184,144,42,.45);background:rgba(184,144,42,.03);}
    .check-input{width:16px;height:16px;min-width:16px;margin-top:1px;accent-color:var(--ink);cursor:pointer;}
    .check-text{font-size:.79rem;font-weight:300;color:var(--ink2);line-height:1.65;cursor:pointer;}
    .check-text strong{font-weight:600;color:var(--ink);}
    .sig-wrap{border:1px solid var(--rule);background:#fff;margin-bottom:12px;position:relative;overflow:hidden;}
    .sig-wrap::before{content:'';position:absolute;left:0;top:0;bottom:0;width:3px;background:var(--rule);transition:background .25s;}
    .sig-wrap.has-sig::before{background:var(--sig-blue);}
    .sig-label-row{display:flex;align-items:center;justify-content:space-between;padding:10px 16px;border-bottom:1px solid var(--rule);}
    .sig-label-left{font-size:.63rem;font-weight:600;letter-spacing:1.8px;text-transform:uppercase;color:var(--muted);}
    .sig-clear{font-size:.62rem;font-weight:500;letter-spacing:1.2px;text-transform:uppercase;color:var(--muted);background:none;cursor:pointer;padding:4px 8px;border:1px solid var(--rule);transition:all .18s;}
    .sig-clear:hover{border-color:var(--ink3);color:var(--ink);}
    canvas#sigCanvas{display:block;width:100%;height:180px;touch-action:none;cursor:crosshair;}
    .sig-hint{font-size:.69rem;font-weight:300;color:var(--muted);margin-top:6px;margin-bottom:20px;}
    .bn{display:flex;align-items:center;gap:7px;font-size:.66rem;font-weight:300;color:var(--muted);padding:9px 0;border-bottom:1px solid var(--rule);}
    .bd{width:100%;padding:16px 20px;background:var(--ink);color:#fff;font-family:'Jost',sans-serif;font-size:.76rem;font-weight:500;letter-spacing:2px;text-transform:uppercase;border:1px solid var(--ink);cursor:pointer;display:flex;align-items:center;justify-content:space-between;position:relative;overflow:hidden;transition:background .2s,border-color .2s;}
    .bd::before{content:'';position:absolute;left:0;top:0;height:100%;width:0;background:var(--gold);transition:width .38s ease;z-index:0;}
    .bd:hover::before{width:100%;}
    .bd:hover{border-color:var(--gold);}
    .bd>*{position:relative;z-index:1;}
    .bd:disabled{opacity:.42;cursor:not-allowed;}
    .bd:disabled::before{display:none;}
    .sp2{width:14px;height:14px;border:1.5px solid rgba(255,255,255,.22);border-top-color:#fff;border-radius:50%;animation:spn .7s linear infinite;}
    @keyframes spn{to{transform:rotate(360deg);}}
    .rf{height:50px;border-top:1px solid var(--rule);display:flex;align-items:center;justify-content:space-between;padding:0 52px;flex-shrink:0;}
    .rfl{font-size:.67rem;font-weight:300;color:var(--muted);}
    .rfr{font-size:.63rem;font-weight:500;letter-spacing:1.2px;text-transform:uppercase;color:var(--muted);opacity:.55;}
    .contacts{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:20px;margin-bottom:32px;}
    .contact-card{border:1px solid var(--rule);padding:14px 16px;background:#fff;}
    .contact-role{font-size:.58rem;font-weight:600;letter-spacing:2px;text-transform:uppercase;color:var(--gold);margin-bottom:5px;}
    .contact-name{font-size:.82rem;font-weight:500;color:var(--ink);margin-bottom:3px;}
    .contact-detail{font-size:.72rem;font-weight:300;color:var(--muted);}
    @media(max-width:960px){body{grid-template-columns:1fr;}.pl{position:static;height:auto;padding:32px 28px;order:2;}.pr{order:1;}.snav,.ring{display:none;}.lh{font-size:1.75rem;}.ls2{margin-bottom:20px;}.ml{display:grid;grid-template-columns:1fr 1fr;}}
    @media(max-width:720px){.rm{padding:28px 24px;}.tb,.rf{padding:0 20px;}.ft{font-size:1.75rem;}.contacts{grid-template-columns:1fr;}}
    @media(max-width:480px){.rm{padding:20px 16px;}.agree-box{height:260px;}canvas#sigCanvas{height:140px;}}
  </style>
</head>
<body>

<aside class="pl">
  <div class="li">
    <div class="lt">
      <button class="lb on" onclick="setLang('ro')" id="btn-ro">RO</button>
      <div class="lsep"></div>
      <button class="lb" onclick="setLang('en')" id="btn-en">EN</button>
    </div>
    <div class="ring">
      <svg width="52" height="52" viewBox="0 0 52 52" fill="none">
        <circle cx="26" cy="26" r="22" stroke="rgba(184,144,42,.18)" stroke-width=".75"/>
        <g fill="#b8902a" opacity=".72">
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(0 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(30 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(60 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(90 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(120 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(150 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(180 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(210 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(240 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(270 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(300 26 26)"/>
          <polygon points="26,5 26.75,7.2 29.1,7.2 27.2,8.55 27.95,10.75 26,9.4 24.05,10.75 24.8,8.55 22.9,7.2 25.25,7.2" transform="rotate(330 26 26)"/>
        </g>
      </svg>
    </div>
    <h2 class="lh">Model<br/>European<br/>Union <em>Timisoara</em></h2>
    <p class="ls2" id="lsub">Prima Editie · 2026 · Acord de Participare</p>
    <ul class="ml">
      <li class="mi"><svg class="mic" width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="rgba(255,255,255,.5)" stroke-width="1.1"><rect x="1" y="2" width="11" height="10" rx=".8"/><path d="M1 5.5h11M4 1v2.5M9 1v2.5"/></svg><div><span class="mil" id="m1">Perioada</span><span class="miv">24-29 Martie 2026</span></div></li>
      <li class="mi"><svg class="mic" width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="rgba(255,255,255,.5)" stroke-width="1.1"><path d="M6.5 1C4.57 1 3 2.57 3 4.5c0 2.8 3.5 7 3.5 7s3.5-4.2 3.5-7C10 2.57 8.43 1 6.5 1z"/><circle cx="6.5" cy="4.5" r="1.2"/></svg><div><span class="mil" id="m2">Locatie</span><span class="miv">Timisoara, Romania</span></div></li>
      <li class="mi"><svg class="mic" width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="rgba(255,255,255,.5)" stroke-width="1.1"><path d="M6.5 1L1 4.5v5L6.5 12 12 9.5v-5L6.5 1z"/><path d="M6.5 1v11M1 4.5l5.5 3 5.5-3"/></svg><div><span class="mil" id="m3">Patronaj</span><span class="miv">Parlamentul European</span></div></li>
      <li class="mi"><svg class="mic" width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="rgba(255,255,255,.5)" stroke-width="1.1"><circle cx="6.5" cy="6.5" r="5.5"/><path d="M6.5 1.2S4.2 3 4.2 6.5s2.3 5.3 2.3 5.3M6.5 1.2S8.8 3 8.8 6.5 6.5 11.8 6.5 11.8M1.2 6.5h10.6"/></svg><div><span class="mil" id="m4">Institutie</span><span class="miv">Universitatea de Vest din Timisoara</span></div></li>
    </ul>
    <div class="snav">
      <div class="snav-label" id="snav-label">Pasi</div>
      <div class="step-item active" id="step1-nav" onclick="scrollToSection('sec-data')"><div class="step-num">1</div><span class="step-text" id="sn1">Date personale</span></div>
      <div class="step-item" id="step2-nav" onclick="scrollToSection('sec-agree')"><div class="step-num">2</div><span class="step-text" id="sn2">Termeni si conditii</span></div>
      <div class="step-item" id="step3-nav" onclick="scrollToSection('sec-sig')"><div class="step-num">3</div><span class="step-text" id="sn3">Semnatura</span></div>
      <div class="step-item" id="step4-nav" onclick="scrollToSection('sec-dl')"><div class="step-num">4</div><span class="step-text" id="sn4">Descarcare acord</span></div>
    </div>
  </div>
</aside>

<div class="pr">
  <div class="tb">
    <span class="tbl" id="tblabel">Sistem de Semnare Digitala</span>
    <div class="sp"><div class="sd"></div><span class="st" id="stlabel">Disponibil</span></div>
  </div>
  <div class="rm">
    <div class="fe"><div class="fel"></div><div class="fet" id="eyebrow">Document Oficial</div></div>
    <h1 class="ft" id="formtitle">Acord de Participare,<br/>Conduita si Raspundere</h1>
    <p class="fd" id="formdesc">Completeaza datele personale, citeste termenii acordului, bifeaza acceptul si semneaza olograf. Acordul va fi generat automat in format PDF, gata de transmitere.</p>
    <div class="contacts">
      <div class="contact-card"><div class="contact-role" id="cr1">Director General</div><div class="contact-name">Viorel Lambu</div><div class="contact-detail">viorel.lambu04@e-uvt.ro<br/>+40 725 580 476</div></div>
      <div class="contact-card"><div class="contact-role" id="cr2">Project Manager</div><div class="contact-name">Paula Iovescu</div><div class="contact-detail">paula.iovescu04@e-uvt.ro<br/>+40 758 148 025</div></div>
    </div>
    <div class="section-block" id="sec-data">
      <div class="sdiv"><div class="sdiv-line"></div><div class="sdiv-label" id="sec1-label">01 · Date Personale</div><div class="sdiv-line"></div></div>
      <div class="fi"><div class="fll"><svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="1.1"><circle cx="6.5" cy="4" r="2.2"/><path d="M1 11.5c0-2.4 2.46-4.3 5.5-4.3s5.5 1.9 5.5 4.3"/></svg><span class="flt" id="lname">Nume si Prenume</span><span class="freq">*</span></div><input type="text" id="f-name" placeholder="ex. Popescu Maria"/>
<div class="fsh">Folositi doar litere latine, fara diacritice · Latin letters only, no special characters</div></div>
      <div class="fi"><div class="fll"><svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="1.1"><rect x="1.5" y="1.5" width="10" height="10" rx=".7"/><path d="M4 4.5h5M4 6.5h5M4 8.5h3"/></svg><span class="flt" id="lid">CNP / ID / Numar Pasaport</span><span class="freq">*</span></div><input type="text" id="f-id" placeholder="ex. 1900101123456"/></div>
      <div class="fi"><div class="fll"><svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="1.1"><circle cx="6.5" cy="6.5" r="5.5"/><path d="M6.5 1.2S4.2 3 4.2 6.5s2.3 5.3 2.3 5.3M6.5 1.2S8.8 3 8.8 6.5 6.5 11.8 6.5 11.8M1.2 6.5h10.6"/></svg><span class="flt" id="lcit">Cetatenie</span><span class="freq">*</span></div><input type="text" id="f-cit" placeholder="ex. Romana"/></div>
      <div class="fi"><div class="fll"><svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="1.1"><path d="M6.5 1C4.57 1 3 2.57 3 4.5c0 2.8 3.5 7 3.5 7s3.5-4.2 3.5-7C10 2.57 8.43 1 6.5 1z"/><circle cx="6.5" cy="4.5" r="1.2"/></svg><span class="flt" id="ldom">Domiciliu</span><span class="freq">*</span></div><input type="text" id="f-dom" placeholder="ex. Str. Libertatii 12, Cluj-Napoca"/></div>
      <div class="fi"><div class="fll"><svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="1.1"><rect x="1" y="3" width="11" height="7" rx=".7"/><path d="M1 3.5l5.5 3.5 5.5-3.5"/></svg><span class="flt" id="lemail">E-mail</span><span class="freq">*</span></div><input type="email" id="f-email" placeholder="ex. maria.popescu@email.ro"/></div>
      <div class="fi"><div class="fll"><svg width="13" height="13" viewBox="0 0 13 13" fill="none" stroke="currentColor" stroke-width="1.1"><rect x="2.5" y="1" width="8" height="11" rx="1.2"/><path d="M5 9.5h3"/></svg><span class="flt" id="ltel">Telefon</span><span class="freq">*</span></div><input type="tel" id="f-tel" placeholder="ex. +40 7XX XXX XXX"/></div>
    </div>
    <div class="section-block" id="sec-agree">
      <div class="sdiv"><div class="sdiv-line"></div><div class="sdiv-label" id="sec2-label">02 · Termeni si Conditii</div><div class="sdiv-line"></div></div>
      <div class="agree-box" id="agree-text-box"><div class="agree-scroll-fade"></div></div>
      <div class="check-row" id="check-row" onclick="toggleCheck()">
        <input type="checkbox" class="check-input" id="chk-agree" onclick="event.stopPropagation();toggleCheck()"/>
        <label class="check-text" id="chk-label" for="chk-agree"><strong>Sunt de acord cu toti termenii prevazuti in prezentul acord</strong> si declar pe propria raspundere ca am citit, am inteles si accept integral conditiile de participare, conduita si asumare a raspunderii stabilite de Organizatorul MEU Timisoara 2026.</label>
      </div>
    </div>
    <div class="section-block" id="sec-sig">
      <div class="sdiv"><div class="sdiv-line"></div><div class="sdiv-label" id="sec3-label">03 · Semnatura Olografa</div><div class="sdiv-line"></div></div>
      <div class="sig-wrap" id="sig-wrap">
        <div class="sig-label-row"><span class="sig-label-left" id="sig-label-left">Semneaza in spatiul de mai jos</span><button class="sig-clear" onclick="clearSig()" id="sig-clear-btn">Sterge</button></div>
        <canvas id="sigCanvas"></canvas>
      </div>
      <div class="sig-hint" id="sig-hint">Folositi mouse-ul, stylus-ul sau degetul pe ecran tactil · Semnatura va aparea in albastru pe documentul PDF</div>
    </div>
    <div class="section-block" id="sec-dl">
      <div class="sdiv"><div class="sdiv-line"></div><div class="sdiv-label" id="sec4-label">04 · Generare Document</div><div class="sdiv-line"></div></div>
      <div class="bn"><svg width="11" height="11" viewBox="0 0 11 11" fill="none" stroke="currentColor" stroke-width="1.1"><circle cx="5.5" cy="5.5" r="4.5"/><path d="M5.5 5v2.5M5.5 3.8h.01"/></svg><span id="bnote">Document PDF · Format A4 · Pregatit pentru transmitere</span></div>
      <button class="bd" id="downloadBtn" onclick="generatePDF()">
        <span id="btnText">Genereaza si Descarca Acordul</span>
        <svg id="btnIcon" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.4"><path d="M7 2v7M4 6.5l3 3.5 3-3.5M2 12h10"/></svg>
      </button>
      <p style="font-size:.72rem;font-weight:300;color:var(--muted);margin-top:16px;line-height:1.7;" id="dl-footer">Dupa descarcare, transmite acordul semnat la <strong>office.meutm@gmail.com</strong> sau direct catre Viorel Lambu / Paula Iovescu.</p>
    </div>
  </div>
  <div class="rf">
    <span class="rfl">MEU Timisoara 2026 &nbsp;·&nbsp; Universitatea de Vest din Timisoara</span>
    <span class="rfr" id="footr">Patronaj Parlamentul European</span>
  </div>
</div>

<script>
/* ── san(): strips non-WinAnsi chars for pdf-lib ── */
function san(s){
  if(s==null)return'';
  var map={
    '\u0103':'a','\u0102':'A','\u00e2':'a','\u00c2':'A',
    '\u00ee':'i','\u00ce':'I',
    '\u0219':'s','\u015f':'s','\u015e':'S','\u0218':'S',
    '\u021b':'t','\u0163':'t','\u0162':'T','\u021a':'T',
    '\u00e0':'a','\u00e1':'a','\u00e4':'a','\u00e5':'a',
    '\u00e8':'e','\u00e9':'e','\u00ea':'e','\u00eb':'e',
    '\u00ec':'i','\u00ed':'i','\u00ef':'i',
    '\u00f2':'o','\u00f3':'o','\u00f4':'o','\u00f6':'o',
    '\u00f9':'u','\u00fa':'u','\u00fb':'u','\u00fc':'u',
    '\u00e7':'c','\u00f1':'n',
    '\u00c0':'A','\u00c1':'A','\u00c4':'A','\u00c5':'A',
    '\u00c8':'E','\u00c9':'E','\u00ca':'E','\u00cb':'E',
    '\u00cc':'I','\u00cd':'I','\u00cf':'I',
    '\u00d2':'O','\u00d3':'O','\u00d4':'O','\u00d6':'O',
    '\u00d9':'U','\u00da':'U','\u00db':'U','\u00dc':'U',
    '\u00c7':'C','\u00d1':'N'
  };
  var out='';
  for(var i=0;i<s.length;i++){
    var c=s[i];
    if(map[c]!==undefined)out+=map[c];
    else if(c.charCodeAt(0)<128)out+=c;
    // else skip
  }
  return out;
}

const T={
  ro:{
    lsub:'Prima Editie · 2026 · Acord de Participare',
    m1:'Perioada',m2:'Locatie',m3:'Patronaj',m4:'Institutie',
    tblabel:'Sistem de Semnare Digitala',stlabel:'Disponibil',
    eyebrow:'Document Oficial',
    formtitle:'Acord de Participare,<br/>Conduita si Raspundere',
    formdesc:'Completeaza datele personale, citeste termenii acordului, bifeaza acceptul si semneaza olograf. Acordul va fi generat automat in format PDF, gata de transmitere.',
    cr1:'Director General',cr2:'Manager de Proiect',
    sec1:'01 · Date Personale',sec2:'02 · Termeni si Conditii',sec3:'03 · Semnatura Olografa',sec4:'04 · Generare Document',
    lname:'Nume si Prenume',lid:'CNP / ID / Numar Pasaport',lcit:'Cetatenie',ldom:'Domiciliu',lemail:'E-mail',ltel:'Telefon',
    snav:'Pasi',sn1:'Date personale',sn2:'Termeni si conditii',sn3:'Semnatura',sn4:'Descarcare acord',
    chkLabel:'<strong>Sunt de acord cu toti termenii prevazuti in prezentul acord</strong> si declar pe propria raspundere ca am citit, am inteles si accept integral conditiile de participare, conduita si asumare a raspunderii stabilite de Organizatorul MEU Timisoara 2026.',
    sig_left:'Semneaza in spatiul de mai jos',sig_clear:'Sterge',
    sig_hint:'Folositi mouse-ul, stylus-ul sau degetul pe ecran tactil · Semnatura va aparea in albastru pe documentul PDF',
    bnote:'Document PDF · Format A4 · Pregatit pentru transmitere',
    btnDown:'Genereaza si Descarca Acordul',btnGen:'Se genereaza...',btnDone:'Acord Descarcat',
    footr:'Patronaj Parlamentul European',
    dl_footer:'Dupa descarcare, transmite acordul semnat la <strong>office.meutm@gmail.com</strong> sau direct catre Viorel Lambu / Paula Iovescu.',
    aName:'Completeaza toate campurile obligatorii.',aChk:'Bifeaza acordul cu termenii.',aSig:'Adauga semnatura olografa.',aErr:'Eroare la generare:\n',
    pdf_title:'ACORD DE PARTICIPARE, CONDUITA SI ASUMARE A RASPUNDERII',
    pdf_sub:'Model European Union Timisoara 2026 (MEU Timisoara 2026)',
    pdf_period:'Perioada: 24-29 Martie 2026  |  Locatie: Timisoara, Romania',
    pdf_org:'Organizator: Universitatea de Vest din Timisoara (UVT) prin echipa MEU Timisoara 2026',
    pdf_sign:'Semnatura',pdf_date:'Data',
    pdf_confirm:'Prin semnatura de mai sus, Participantul confirma ca a citit, a inteles si accepta integral prezentul acord.',
    pdf_filename:'Acord_MEU_Timisoara_2026',page:'Pagina',of:'din',
    f_name:'Nume si Prenume',f_id:'CNP / ID / Pasaport',f_cit:'Cetatenie',f_dom:'Domiciliu',f_email:'E-mail',f_tel:'Telefon',
    data_header:'DATE PARTICIPANT',part_header:'PARTICIPANT',name_lbl:'Nume si prenume:',
  },
  en:{
    lsub:'First Edition · 2026 · Participation Agreement',
    m1:'Dates',m2:'Location',m3:'Patronage',m4:'Institution',
    tblabel:'Digital Signing System',stlabel:'Available',
    eyebrow:'Official Document',
    formtitle:'Participation, Conduct<br/>and Liability Agreement',
    formdesc:'Fill in your personal data, read the agreement terms, check your acceptance and sign. The agreement will be automatically generated as a PDF, ready for submission.',
    cr1:'Director General',cr2:'Project Manager',
    sec1:'01 · Personal Data',sec2:'02 · Terms & Conditions',sec3:'03 · Handwritten Signature',sec4:'04 · Document Generation',
    lname:'Full Name',lid:'National ID / Passport Number',lcit:'Citizenship',ldom:'Address',lemail:'E-mail',ltel:'Phone',
    snav:'Steps',sn1:'Personal data',sn2:'Terms & conditions',sn3:'Signature',sn4:'Download agreement',
    chkLabel:'<strong>I agree with all the terms set out in this agreement</strong> and hereby declare under my own responsibility that I have read, understood and fully accept the participation, conduct and liability conditions established by the MEU Timisoara 2026 Organiser.',
    sig_left:'Sign in the space below',sig_clear:'Clear',
    sig_hint:'Use your mouse, stylus or finger on touchscreen · Signature will appear in blue on the PDF document',
    bnote:'PDF document · A4 format · Ready for submission',
    btnDown:'Generate & Download Agreement',btnGen:'Generating...',btnDone:'Agreement Downloaded',
    footr:'European Parliament Patronage',
    dl_footer:'After downloading, send the signed agreement to <strong>office.meutm@gmail.com</strong> or directly to Viorel Lambu / Paula Iovescu.',
    aName:'Please fill in all required fields.',aChk:'Please accept the agreement terms.',aSig:'Please add your handwritten signature.',aErr:'Error generating PDF:\n',
    pdf_title:'PARTICIPATION, CONDUCT AND LIABILITY ASSUMPTION AGREEMENT',
    pdf_sub:'Model European Union Timisoara 2026 (MEU Timisoara 2026)',
    pdf_period:'Period: 24-29 March 2026  |  Location: Timisoara, Romania',
    pdf_org:'Organiser: West University of Timisoara (UVT) through the MEU Timisoara 2026 team',
    pdf_sign:'Signature',pdf_date:'Date',
    pdf_confirm:'By signing above, the Participant confirms having read, understood and fully accepted this agreement.',
    pdf_filename:'Agreement_MEU_Timisoara_2026',page:'Page',of:'of',
    f_name:'Full Name',f_id:'ID / Passport',f_cit:'Citizenship',f_dom:'Address',f_email:'E-mail',f_tel:'Phone',
    data_header:'PARTICIPANT DATA',part_header:'PARTICIPANT',name_lbl:'Full name:',
  }
};

const AGR={
  ro:[
    {type:'intro',text:'Subsemnatul/a [NAME], CNP/ID/Pasaport [ID], cetatenie [CIT], domiciliat/a in [DOM], e-mail [EMAIL], telefon [TEL] (Participantul), declar pe propria raspundere ca am citit si inteles prezentul acord, precum si Ghidul Participantilor MEU Timisoara 2026, pe care le accept integral. Prezentul acord produce efecte juridice de la data semnarii.'},
    {type:'section',title:'1. Obiect. Natura Juridica',items:['1.1. Prezentul acord stabileste conditiile de participare, conduita obligatorie, regulile privind cazarea si locatiile, procedurile de siguranta, utilizarea imaginii si prelucrarea datelor, precum si consecintele incalcarii acestora.','1.2. Participantul ia act ca MEU Timisoara 2026 se desfasoara in spatii universitare si partenere, iar accesul si participarea pot fi conditionate de respectarea prezentului acord, a regulilor locului si a instructiunilor Organizatorului.']},
    {type:'section',title:'2. Obligatii Esentiale ale Participantului',items:['2.1. Participantul se obliga la conduita decenta si profesionala, respect fata de orice persoana (participanti, organizatori, personal, invitati), inclusiv in mediul online, fara discriminare sau hartuire.','2.2. Participantul se obliga sa fie punctual, sa participe activ la activitatile la care este repartizat si sa respecte codul vestimentar si protocolul evenimentului.','2.3. Participantul se obliga sa respecte regulile de cazare (curatenie, program de liniste, respect fata de colegii de camera si spatiile comune) si sa foloseasca cu grija bunurile puse la dispozitie.','2.4. Participantul se obliga sa respecte instructiunile Organizatorului si ale personalului autorizat privind accesul in locatii, siguranta, fluxurile de deplasare si regulile interne ale spatiilor.']},
    {type:'section',title:'3. Fapte Interzise. Incalcari Relevante',items:['Fara a limita aplicarea oricaror dispozitii legale, se considera incalcari grave urmatoarele:','a) Detinerea, consumul, distribuirea sau orice implicare cu substante ilegale (inclusiv Legea nr. 143/2000).','b) Violenta, amenintari, intimidare, comportamente periculoase, inclusiv fapte prevazute de Codul penal.','c) Hartuire, discriminare, instigare la ura sau comportament degradant, inclusiv fapte contrare O.G. nr. 137/2000.','d) Furt, insusirea bunurilor, acces neautorizat in camere/spatii, incalcarea dreptului la viata privata.','e) Deteriorarea spatiilor ori bunurilor (cazare, mobilier, echipamente), inclusiv prin neglijenta sau vandalism.','f) Publicarea/distribuirea de fotografii sau inregistrari cu persoane identificabile fara consimtamant.']},
    {type:'section',title:'4. Raspundere Civila. Daune',items:['4.1. Participantul isi asuma raspunderea civila delictuala pentru orice prejudiciu cauzat prin fapta proprie, inclusiv daune materiale produse spatiilor de cazare si locatiilor evenimentului (art. 1349 si urm. Cod civil).','4.2. Participantul se obliga sa achite integral, la cerere, costurile dovedite ale reparatiilor/inlocuirilor rezultate din fapta sa.']},
    {type:'section',title:'5. Siguranta. Raportarea Incidentelor',items:['5.1. Participantul ia act de existenta persoanelor desemnate pentru siguranta (Safe Persons) si se obliga sa raporteze prompt orice incident (hartuire, discriminare, violenta, risc medical, consum de substante ilegale).','5.2. In caz de pericol imediat, Participantul va apela 112 fara intarziere si va informa Organizatorul cat mai curand.']},
    {type:'section',title:'6. Bunuri Personale. Limitarea Raspunderii Organizatorului',items:['6.1. Participantul este responsabil pentru bunurile sale personale (documente, bani, dispozitive), iar Organizatorul nu raspunde pentru bunuri pierdute/furate/deteriorate, cu exceptia cazurilor prevazute de lege.','6.2. Participantul declara ca este apt/a sa participe si isi asuma riscurile obisnuite aferente deplasarilor si activitatilor.']},
    {type:'section',title:'7. Imagine. Foto-Video',items:['7.1. Participantul isi exprima consimtamantul ca Organizatorul si partenerii desemnati sa realizeze fotografii si inregistrari audio-video in timpul evenimentului si sa le utilizeze pentru comunicare, promovare si arhivare, fara remuneratie.','7.2. Participantul poate solicita restrictionarea utilizarii unei imagini identificabile prin notificare scrisa la office.meutm@gmail.com.']},
    {type:'section',title:'8. Date cu Caracter Personal (GDPR)',items:['8.1. Participantul ia act ca datele sale sunt prelucrate de UVT/Organizator pentru administrarea evenimentului, in conformitate cu Regulamentul (UE) 2016/679 (GDPR) si legislatia nationala aplicabila.','8.2. Drepturile Participantului (acces, rectificare, stergere, restrictionare, opozitie, portabilitate) pot fi exercitate prin solicitare la office.meutm@gmail.com.']},
    {type:'section',title:'9. Sanctiuni Interne. Excludere',items:['9.1. Incalcarea prezentului acord poate atrage: avertisment verbal/scris, restrictionarea accesului la anumite activitati, indepartarea din cazare, excluderea din eveniment.','9.2. In cazul unor fapte susceptibile de incalcarea legii, Organizatorul isi rezerva dreptul de a sesiza autoritatile competente. Excluderea nu inlatura raspunderea legala a Participantului.']},
    {type:'section',title:'10. Legea Aplicabila. Litigii',items:['10.1. Prezentul acord este guvernat de legea romana.','10.2. Eventualele neintelegeri se solutioneaza prioritar pe cale amiabila; in caz contrar, competenta revine instantelor judecatoresti din Romania.']},
    {type:'section',title:'11. Dispozitii Finale',items:['11.1. Prezentul acord intra in vigoare la data semnarii si se aplica pe durata evenimentului, precum si ulterior pentru clauzele cu efecte dupa incheiere (raspundere, date, media).','11.2. Prin semnare, Participantul confirma ca a inteles continutul, il accepta liber si neechivoc si declara ca informatiile furnizate sunt reale.']},
  ],
  en:[
    {type:'intro',text:'The undersigned [NAME], National ID/Passport [ID], citizenship [CIT], residing at [DOM], e-mail [EMAIL], phone [TEL] (the Participant), hereby declares to have read and understood this agreement, as well as the MEU Timisoara 2026 Participants Guide, fully accepting both. This agreement takes legal effect from the date of signing.'},
    {type:'section',title:'1. Subject Matter. Legal Nature',items:['1.1. This agreement establishes the conditions of participation, mandatory conduct, accommodation and venue rules, safety procedures, image rights and data processing, as well as the consequences of any breach.','1.2. The Participant acknowledges that MEU Timisoara 2026 takes place in university and partner premises, and access may be conditioned on compliance with this agreement, venue rules and Organiser instructions.']},
    {type:'section',title:'2. Essential Obligations of the Participant',items:['2.1. The Participant commits to decent and professional conduct, respect for every person (participants, organisers, staff, guests), including online, without discrimination or harassment.','2.2. The Participant commits to punctuality, active participation in assigned activities, and compliance with the dress code and event protocol.','2.3. The Participant commits to respecting accommodation rules (cleanliness, quiet hours, respect for roommates and common areas) and to treating provided goods with care.','2.4. The Participant commits to following Organiser and authorised staff instructions regarding venue access, safety, movement flows and internal venue rules.']},
    {type:'section',title:'3. Prohibited Conduct',items:['Without limiting the application of any legal provisions, the following constitute serious breaches:','a) Possession, consumption, distribution or any involvement with illegal substances.','b) Violence, threats, intimidation, dangerous behaviour, including acts covered by the Criminal Code.','c) Harassment, discrimination, incitement to hatred or degrading behaviour.','d) Theft, misappropriation of property, unauthorised access to rooms/areas, breach of privacy.','e) Damage to premises or property (accommodation, furniture, equipment), including through negligence or vandalism.','f) Publishing/distributing photographs or recordings featuring identifiable persons without consent.']},
    {type:'section',title:'4. Civil Liability. Damages',items:['4.1. The Participant assumes civil liability for any damage caused by their own action or omission, including material damage to accommodation and event venues.','4.2. The Participant agrees to pay in full, upon request, the proven costs of repairs/replacements resulting from their conduct.']},
    {type:'section',title:'5. Safety. Incident Reporting',items:['5.1. The Participant acknowledges the existence of designated Safe Persons and undertakes to promptly report any incident (harassment, discrimination, violence, medical risk, substance use, danger).','5.2. In case of immediate danger, the Participant will call 112 without delay and inform the Organiser as soon as possible.']},
    {type:'section',title:'6. Personal Belongings. Limitation of Organiser Liability',items:['6.1. The Participant is responsible for their personal belongings (documents, money, devices); the Organiser is not liable for lost/stolen/damaged items except where liability cannot be excluded by law.','6.2. The Participant declares fitness to participate and assumes the ordinary risks associated with travel and activities.']},
    {type:'section',title:'7. Image Rights. Photo & Video',items:['7.1. The Participant consents to the Organiser and designated partners taking photographs and audio-video recordings during the event and using them for communication, promotion and archiving, without remuneration.','7.2. The Participant may request restriction of use of an identifiable image by written notification to office.meutm@gmail.com.']},
    {type:'section',title:'8. Personal Data (GDPR)',items:['8.1. The Participant acknowledges that their data is processed by UVT/Organiser for event management purposes, in accordance with Regulation (EU) 2016/679 (GDPR) and applicable national legislation.','8.2. The Participants rights (access, rectification, erasure, restriction, objection, portability) may be exercised by request to office.meutm@gmail.com.']},
    {type:'section',title:'9. Internal Sanctions. Exclusion',items:['9.1. Breach of this agreement may result in: verbal/written warning, restricted access to certain activities, removal from accommodation, exclusion from the event.','9.2. For acts potentially in breach of the law, the Organiser reserves the right to notify competent authorities. Exclusion does not remove the Participants legal liability.']},
    {type:'section',title:'10. Governing Law. Disputes',items:['10.1. This agreement is governed by Romanian law.','10.2. Any disputes shall be resolved preferably by amicable means; otherwise, jurisdiction lies with the competent Romanian courts.']},
    {type:'section',title:'11. Final Provisions',items:['11.1. This agreement enters into force on the date of signing and applies throughout the event and afterwards for clauses producing effects beyond conclusion (liability, data, media).','11.2. By signing, the Participant confirms having understood the content, freely accepts it, and declares the provided information to be accurate.']},
  ]
};

let lang='ro',sigPad;

window.addEventListener('load',function(){
  initSigPad();renderAgree('ro');updateStepNav();
});

function initSigPad(){
  var canvas=document.getElementById('sigCanvas');
  sigPad=new SignaturePad(canvas,{penColor:'#1a4fa3',minWidth:1.2,maxWidth:2.8,velocityFilterWeight:0.7});
  sigPad.addEventListener('endStroke',function(){
    document.getElementById('sig-wrap').classList.add('has-sig');updateStepNav();
  });
  resizeSigCanvas();
  window.addEventListener('resize',resizeSigCanvas);
}
function resizeSigCanvas(){
  var canvas=document.getElementById('sigCanvas');
  var ratio=Math.max(window.devicePixelRatio||1,1);
  var data=sigPad.toData();
  canvas.width=canvas.offsetWidth*ratio;canvas.height=canvas.offsetHeight*ratio;
  canvas.getContext('2d').scale(ratio,ratio);
  sigPad.clear();sigPad.fromData(data);
}
function clearSig(){sigPad.clear();document.getElementById('sig-wrap').classList.remove('has-sig');updateStepNav();}

function setLang(l){
  lang=l;
  document.getElementById('btn-ro').classList.toggle('on',l==='ro');
  document.getElementById('btn-en').classList.toggle('on',l==='en');
  var t=T[l];
  var ids=['lsub','m1','m2','m3','m4','tblabel','stlabel','eyebrow','cr1','cr2','sec1-label','sec2-label','sec3-label','sec4-label','lname','lid','lcit','ldom','lemail','ltel','sig-label-left','sig-clear-btn','sig-hint','bnote','footr','snav-label','sn1','sn2','sn3','sn4'];
  var keys=['lsub','m1','m2','m3','m4','tblabel','stlabel','eyebrow','cr1','cr2','sec1','sec2','sec3','sec4','lname','lid','lcit','ldom','lemail','ltel','sig_left','sig_clear','sig_hint','bnote','footr','snav','sn1','sn2','sn3','sn4'];
  ids.forEach(function(id,i){document.getElementById(id).textContent=t[keys[i]];});
  document.getElementById('formtitle').innerHTML=t.formtitle;
  document.getElementById('formdesc').textContent=t.formdesc;
  document.getElementById('chk-label').innerHTML=t.chkLabel;
  document.getElementById('btnText').textContent=t.btnDown;
  document.getElementById('dl-footer').innerHTML=t.dl_footer;
  renderAgree(l);
}

function renderAgree(l){
  var t=T[l];var box=document.getElementById('agree-text-box');
  var html='<div class="agree-title">'+t.pdf_title+'</div>';
  html+='<div class="agree-subtitle">'+t.pdf_sub+'<br/>'+t.pdf_period+'<br/>'+t.pdf_org+'</div>';
  var intro=AGR[l].find(function(s){return s.type==='intro';});
  if(intro)html+='<div class="agree-para" style="font-style:italic;color:#555;">'+intro.text+'</div>';
  AGR[l].filter(function(s){return s.type==='section';}).forEach(function(s){
    html+='<div class="agree-section"><div class="agree-section-title">'+s.title+'</div>';
    s.items.forEach(function(i){html+='<div class="agree-para">'+i+'</div>';});
    html+='</div>';
  });
  html+='<div class="agree-scroll-fade"></div>';
  box.innerHTML=html;
}

function toggleCheck(){
  var chk=document.getElementById('chk-agree');chk.checked=!chk.checked;
  document.getElementById('check-row').classList.toggle('checked',chk.checked);
  updateStepNav();
}
function scrollToSection(id){document.getElementById(id).scrollIntoView({behavior:'smooth',block:'start'});}
function updateStepNav(){
  var d1=document.getElementById('f-name').value.trim().length>0;
  var d2=document.getElementById('chk-agree').checked;
  var d3=sigPad&&!sigPad.isEmpty();
  ['step1-nav','step2-nav','step3-nav','step4-nav'].forEach(function(id,i){
    var el=document.getElementById(id);var done=[d1,d2,d3,false][i];
    el.classList.toggle('done',done);el.classList.toggle('active',!done);
  });
}

async function generatePDF(){
  var t=T[lang];
  var name=document.getElementById('f-name').value.trim();
  var fid=document.getElementById('f-id').value.trim();
  var cit=document.getElementById('f-cit').value.trim();
  var dom=document.getElementById('f-dom').value.trim();
  var email=document.getElementById('f-email').value.trim();
  var tel=document.getElementById('f-tel').value.trim();
  var valid=true;
  [['f-name',name],['f-id',fid],['f-cit',cit],['f-dom',dom],['f-email',email],['f-tel',tel]].forEach(function(p){
    document.getElementById(p[0]).classList.toggle('err',!p[1]);if(!p[1])valid=false;
  });
  if(!valid){alert(t.aName);scrollToSection('sec-data');return;}
  if(!document.getElementById('chk-agree').checked){alert(t.aChk);scrollToSection('sec-agree');return;}
  if(sigPad.isEmpty()){alert(t.aSig);scrollToSection('sec-sig');return;}

  var btn=document.getElementById('downloadBtn');btn.disabled=true;
  document.getElementById('btnText').textContent=t.btnGen;
  document.getElementById('btnIcon').outerHTML='<span class="sp2" id="btnIcon"></span>';

  try{
    var PDFDoc=PDFLib.PDFDocument;var rgb=PDFLib.rgb;var SF=PDFLib.StandardFonts;
    var pdfDoc=await PDFDoc.create();
    var font=await pdfDoc.embedFont(SF.Helvetica);
    var fontB=await pdfDoc.embedFont(SF.HelveticaBold);

    var sigUrl=sigPad.toDataURL('image/png');
    var sigB64=sigUrl.split(',')[1];
    var sigBytes=Uint8Array.from(atob(sigB64),function(c){return c.charCodeAt(0);});
    var sigImg=await pdfDoc.embedPng(sigBytes);
    var sigD=sigImg.scale(0.35);

    var euB=rgb(0,0.2,0.6),euG=rgb(0.72,0.56,0.16),ink=rgb(0.04,0.09,0.15),mut=rgb(0.45,0.5,0.58),lg=rgb(0.88,0.9,0.94);
    var W=595.28,H=841.89,ML=54,MR=54,MT=72,MB=54,CW=W-ML-MR;
    var now=new Date();
    var ds=now.getDate().toString().padStart(2,'0')+' / '+(now.getMonth()+1).toString().padStart(2,'0')+' / '+now.getFullYear();

    var pages=[],cp=null,cy=0;

    function ap(){
      cp=pdfDoc.addPage([W,H]);cy=H-MT-16;pages.push(cp);dh(cp);
    }
    function es(n){if(cy-n<MB+60)ap();}

    function dh(pg){
      pg.drawRectangle({x:0,y:H-38,width:W,height:38,color:euB});
      pg.drawText('· · · · · · · · · · · ·',{x:ML,y:H-22,size:9,font:fontB,color:rgb(1,0.84,0)});
      var hw=fontB.widthOfTextAtSize('MEU TIMISOARA 2026',9);
      pg.drawText('MEU TIMISOARA 2026',{x:W-MR-hw,y:H-22,size:9,font:fontB,color:rgb(1,0.92,0.6)});
      pg.drawRectangle({x:0,y:H-54,width:W,height:16,color:rgb(0.97,0.97,0.98)});
      pg.drawText(san(t.pdf_sub),{x:ML,y:H-51,size:7,font:font,color:mut});
      var pd=san(t.pdf_period);
      pg.drawText(pd,{x:W-MR-font.widthOfTextAtSize(pd,7),y:H-51,size:7,font:font,color:mut});
      pg.drawLine({start:{x:ML,y:H-58},end:{x:W-MR,y:H-58},thickness:0.5,color:euG,opacity:0.5});
    }

    function df(pg,n,tot){
      pg.drawLine({start:{x:ML,y:MB+28},end:{x:W-MR,y:MB+28},thickness:0.5,color:lg});
      pg.drawText('office.meutm@gmail.com',{x:ML,y:MB+14,size:7,font:font,color:mut});
      var ps=t.page+' '+n+' '+t.of+' '+tot;
      pg.drawText(ps,{x:W-MR-font.widthOfTextAtSize(ps,7),y:MB+14,size:7,font:font,color:mut});
      var ot='Universitatea de Vest din Timisoara';
      pg.drawText(ot,{x:(W-font.widthOfTextAtSize(ot,6.5))/2,y:MB+14,size:6.5,font:font,color:mut,opacity:0.7});
    }

    function wrap(txt,fn,sz,mw){
      var words=san(txt).split(' '),lines=[],cur='';
      words.forEach(function(w){
        var test=cur?cur+' '+w:w;
        if(fn.widthOfTextAtSize(test,sz)>mw){if(cur)lines.push(cur);cur=w;}else cur=test;
      });
      if(cur)lines.push(cur);
      return lines;
    }

    ap();
    wrap(t.pdf_title,fontB,13,CW).forEach(function(l){cp.drawText(l,{x:ML,y:cy,size:13,font:fontB,color:euB});cy-=17;});
    cy-=4;
    cp.drawLine({start:{x:ML,y:cy},end:{x:W-MR,y:cy},thickness:1,color:euG,opacity:0.6});cy-=12;
    [t.pdf_org].forEach(function(ol){
      wrap(ol,font,8,CW).forEach(function(l){cp.drawText(l,{x:ML,y:cy,size:8,font:font,color:mut});cy-=11;});
    });
    cy-=12;
    cp.drawRectangle({x:ML,y:cy-72,width:CW,height:78,color:rgb(0.97,0.98,1),borderColor:lg,borderWidth:0.5});
    cp.drawText(t.data_header,{x:ML+10,y:cy-1,size:7,font:fontB,color:euB});
    var fields=[[t.f_name,name],[t.f_id,fid],[t.f_cit,cit],[t.f_dom,dom],[t.f_email,email],[t.f_tel,tel]];
    var fy=cy-14,hw2=(CW-20)/2;
    fields.forEach(function(f,i){
      var col=i%2,fx=ML+10+(col*(hw2+10));
      cp.drawText(san(f[0]).toUpperCase(),{x:fx,y:fy,size:6,font:fontB,color:mut});
      var v=san(f[1]);if(v.length>32)v=v.substring(0,30)+'...';
      cp.drawText(v,{x:fx,y:fy-9,size:8,font:font,color:ink});
      if(col===1)fy-=20;
    });
    cy-=90;

    var lines=[];
    var ib=AGR[lang].find(function(s){return s.type==='intro';});
    if(ib){
      var it=ib.text.replace('[NAME]',name).replace('[ID]',fid).replace('[CIT]',cit).replace('[DOM]',dom).replace('[EMAIL]',email).replace('[TEL]',tel);
      lines.push({t:'intro',v:it});
    }
    AGR[lang].filter(function(s){return s.type==='section';}).forEach(function(s){
      lines.push({t:'st',v:s.title});
      s.items.forEach(function(i){lines.push({t:'body',v:i});});
    });
    lines.push({t:'sp'});lines.push({t:'sig'});

    for(var i=0;i<lines.length;i++){
      var b=lines[i];
      if(b.t==='sp'){cy-=14;continue;}
      if(b.t==='sig'){
        es(160);
        cp.drawLine({start:{x:ML,y:cy},end:{x:W-MR,y:cy},thickness:0.5,color:lg});cy-=14;
        cp.drawText(t.part_header,{x:ML,y:cy,size:9,font:fontB,color:euB});cy-=14;
        cp.drawText(san(t.name_lbl),{x:ML,y:cy,size:8,font:fontB,color:ink});
        cp.drawText(san(name),{x:ML+100,y:cy,size:8,font:font,color:ink});
        cp.drawLine({start:{x:ML+95,y:cy-2},end:{x:ML+300,y:cy-2},thickness:0.3,color:mut});cy-=18;
        wrap(t.pdf_confirm,font,7.5,CW).forEach(function(l){cp.drawText(l,{x:ML,y:cy,size:7.5,font:font,color:mut,opacity:0.8});cy-=11;});
        cy-=8;
        cp.drawText(san(t.pdf_sign)+':',{x:ML,y:cy,size:8,font:fontB,color:ink});
        cp.drawText(san(t.pdf_date)+': '+ds,{x:ML+220,y:cy,size:8,font:fontB,color:ink});
        cy-=8;
        var sh=Math.min(sigD.height,60),sw=sh*(sigD.width/sigD.height);
        cp.drawImage(sigImg,{x:ML,y:cy-sh-4,width:sw,height:sh});
        cp.drawLine({start:{x:ML,y:cy-sh-8},end:{x:ML+180,y:cy-sh-8},thickness:0.4,color:mut});
        cy-=sh+20;continue;
      }
      if(b.t==='intro'){
        es(30);
        var wl=wrap(b.v,font,8,CW);
        wl.forEach(function(l){es(12);cp.drawText(l,{x:ML+6,y:cy,size:8,font:font,color:rgb(0.2,0.3,0.45),opacity:0.9});cy-=11;});
        cy-=8;continue;
      }
      if(b.t==='st'){
        es(22);cy-=4;
        cp.drawText(san(b.v).toUpperCase(),{x:ML,y:cy,size:8,font:fontB,color:euB});
        cy-=4;cp.drawLine({start:{x:ML,y:cy},end:{x:ML+CW*0.6,y:cy},thickness:0.3,color:euG,opacity:0.5});cy-=10;continue;
      }
      if(b.t==='body'){
        wrap(b.v,font,8.2,CW-4).forEach(function(l){es(12);cp.drawText(l,{x:ML+2,y:cy,size:8.2,font:font,color:ink});cy-=11.5;});
        cy-=3;
      }
    }

    var tot=pages.length;
    pages.forEach(function(pg,i){df(pg,i+1,tot);});

    var bytes=await pdfDoc.save();
    var url=URL.createObjectURL(new Blob([bytes],{type:'application/pdf'}));
    var a=document.createElement('a');a.href=url;
    a.download=t.pdf_filename+'_'+san(name).replace(/\s+/g,'_')+'.pdf';
    document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);

    document.getElementById('btnIcon').outerHTML='<svg id="btnIcon" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.6"><polyline points="2,7 5.5,10.5 12,3.5"/></svg>';
    document.getElementById('btnText').textContent=t.btnDone;
    btn.style.background='#1a4a2e';btn.style.borderColor='#1a4a2e';
    setTimeout(function(){
      document.getElementById('btnText').textContent=t.btnDown;
      document.getElementById('btnIcon').outerHTML='<svg id="btnIcon" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.4"><path d="M7 2v7M4 6.5l3 3.5 3-3.5M2 12h10"/></svg>';
      btn.style.background='';btn.style.borderColor='';btn.disabled=false;
    },3500);
  }catch(err){
    alert(T[lang].aErr+err.message);
    document.getElementById('btnText').textContent=T[lang].btnDown;
    document.getElementById('btnIcon').outerHTML='<svg id="btnIcon" width="14" height="14" viewBox="0 0 14 14" fill="none" stroke="currentColor" stroke-width="1.4"><path d="M7 2v7M4 6.5l3 3.5 3-3.5M2 12h10"/></svg>';
    btn.disabled=false;
  }
}

['f-name','f-id','f-cit','f-dom','f-email','f-tel'].forEach(function(id){
  document.getElementById(id).addEventListener('input',updateStepNav);
});
</script>
</body>
</html>
